<app-header-nav-black [showBanner]="false"></app-header-nav-black>

<section class="gallery">
  <div class="header">
    <div class="title-row-page">
      <h1>Galería</h1>
    </div>
  </div>

  <!-- Contenedor principal de la galería -->
  <div class="bento-gallery">
    <!-- Mostrar spinner de carga mientras se cargan las imágenes -->
    <div *ngIf="loading" class="loading-container">
      <div class="spinner"></div>
      <p>Cargando imágenes...</p>
    </div>

    <!-- Mensaje de error en caso de fallos -->
    <div *ngIf="error" class="error-message">
      <p>{{ error }}</p>
    </div>

    <!-- Contenedor de la cuadrícula bento -->
    <div *ngIf="!loading && !error" class="bento-container">
      <!-- Iterar sobre cada imagen -->
      <div
        *ngFor="let image of images; let i = index"
        class="bento-item"
      >
        <img
          [src]="image.url"
          [alt]="image.title"
          class="bento-image"
          loading="lazy"
          (click)="openImage(image, i)"
        />
        <a
          class="download-btn"
          [href]="image.url"
          [attr.download]="image.filename || (image.title + '.jpg')"
          [attr.aria-label]="'Descargar ' + image.title"
          title="Descargar"
          (click)="$event.stopPropagation()"
        >
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7 10 12 15 17 10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
        </a>
        <div class="image-overlay">
          <h3 class="image-title">{{ image.title }}</h3>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Lightbox -->
<div class="lightbox-backdrop" *ngIf="selectedImage" (click)="closeLightbox()">
  <div class="lightbox" (click)="$event.stopPropagation()">
    <button class="lightbox-close" (click)="closeLightbox()" aria-label="Cerrar">×</button>
    <a
      class="lightbox-download"
      [href]="selectedImage.url"
      [attr.download]="selectedImage.filename || (selectedImage.title + '.jpg')"
      [attr.aria-label]="'Descargar ' + selectedImage.title"
      title="Descargar"
      (click)="$event.stopPropagation()"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7 10 12 15 17 10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
    </a>
    <button class="lightbox-nav left" (click)="prevImage()" aria-label="Anterior">❮</button>
    <button class="lightbox-nav right" (click)="nextImage()" aria-label="Siguiente">❯</button>
    <img [src]="selectedImage.url" [alt]="selectedImage.title" />
    <p class="lightbox-caption">{{ selectedImage.title }}</p>
  </div>
  </div>
